<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta name="generator" content="HTML Tidy, see www.w3.org">
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link type="text/css" rel="stylesheet" href="style.css">
<!-- Generated by The Open Group's rhtm tool v1.2.1 -->
<!-- Copyright (c) 2001-2004 IEEE and The Open Group, All Rights Reserved -->
<title>pthread_mutex_timedlock</title>
</head>
<body bgcolor="white">
<script type="text/javascript" language="JavaScript" src="../jscript/codes.js">
</script>

<basefont size="3"> <a name="pthread_mutex_timedlock"></a> <a name="tag_03_542"></a><!-- pthread_mutex_timedlock -->
 <!--header start-->
<center><font size="2">The Open Group Base Specifications Issue 6<br>
IEEE Std 1003.1, 2004 Edition<br>
Copyright &copy; 2001-2004 The IEEE and The Open Group, All Rights reserved.</font></center>

<!--header end-->
<hr size="2" noshade>
<h4><a name="tag_03_542_01"></a>NAME</h4>

<blockquote>pthread_mutex_timedlock - lock a mutex (<b>ADVANCED REALTIME</b>)</blockquote>

<h4><a name="tag_03_542_02"></a>SYNOPSIS</h4>

<blockquote class="synopsis">
<div class="box"><code><tt><sup>[<a href="javascript:open_code('THR TMO')">THR TMO</a>]</sup> <img src="../images/opt-start.gif" alt=
"[Option Start]" border="0"> #include &lt;<a href="../basedefs/pthread.h.html">pthread.h</a>&gt;<br>
 #include &lt;<a href="../basedefs/time.h.html">time.h</a>&gt;<br>
<br>
 int pthread_mutex_timedlock(pthread_mutex_t *restrict</tt> <i>mutex</i><tt>,<br>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; const struct timespec *restrict</tt> <i>abs_timeout</i><tt>); <img src=
"../images/opt-end.gif" alt="[Option End]" border="0"></tt></code></div>

<tt><br>
</tt></blockquote>

<h4><a name="tag_03_542_03"></a>DESCRIPTION</h4>

<blockquote>
<p>The <i>pthread_mutex_timedlock</i>() function shall lock the mutex object referenced by <i>mutex</i>. If the mutex is already
locked, the calling thread shall block until the mutex becomes available as in the <a href=
"../functions/pthread_mutex_lock.html"><i>pthread_mutex_lock</i>()</a> function. If the mutex cannot be locked without waiting for
another thread to unlock the mutex, this wait shall be terminated when the specified timeout expires.</p>

<p>The timeout shall expire when the absolute time specified by <i>abs_timeout</i> passes, as measured by the clock on which
timeouts are based (that is, when the value of that clock equals or exceeds <i>abs_timeout</i>), or if the absolute time specified
by <i>abs_timeout</i> has already been passed at the time of the call.</p>

<p><sup>[<a href="javascript:open_code('TMR')">TMR</a>]</sup> <img src="../images/opt-start.gif" alt="[Option Start]" border="0">
If the Timers option is supported, the timeout shall be based on the CLOCK_REALTIME clock; if the Timers option is not supported,
the timeout shall be based on the system clock as returned by the <a href="../functions/time.html"><i>time</i>()</a> function. <img
src="../images/opt-end.gif" alt="[Option End]" border="0"></p>

<p>The resolution of the timeout shall be the resolution of the clock on which it is based. The <b>timespec</b> data type is
defined in the <a href="../basedefs/time.h.html"><i>&lt;time.h&gt;</i></a> header.</p>

<p>Under no circumstance shall the function fail with a timeout if the mutex can be locked immediately. The validity of the
<i>abs_timeout</i> parameter need not be checked if the mutex can be locked immediately.</p>

<p><sup>[<a href="javascript:open_code('TPI')">TPI</a>]</sup> <img src="../images/opt-start.gif" alt="[Option Start]" border="0">
As a consequence of the priority inheritance rules (for mutexes initialized with the PRIO_INHERIT protocol), if a timed mutex wait
is terminated because its timeout expires, the priority of the owner of the mutex shall be adjusted as necessary to reflect the
fact that this thread is no longer among the threads waiting for the mutex. <img src="../images/opt-end.gif" alt="[Option End]"
border="0"></p>
</blockquote>

<h4><a name="tag_03_542_04"></a>RETURN VALUE</h4>

<blockquote>
<p>If successful, the <i>pthread_mutex_timedlock</i>() function shall return zero; otherwise, an error number shall be returned to
indicate the error.</p>
</blockquote>

<h4><a name="tag_03_542_05"></a>ERRORS</h4>

<blockquote>
<p>The <i>pthread_mutex_timedlock</i>() function shall fail if:</p>

<dl compact>
<dt>[EINVAL]</dt>

<dd>The mutex was created with the protocol attribute having the value PTHREAD_PRIO_PROTECT and the calling thread's priority is
higher than the mutex' current priority ceiling.</dd>

<dt>[EINVAL]</dt>

<dd>The process or thread would have blocked, and the <i>abs_timeout</i> parameter specified a nanoseconds field value less than
zero or greater than or equal to 1000 million.</dd>

<dt>[ETIMEDOUT]</dt>

<dd>The mutex could not be locked before the specified timeout expired.</dd>
</dl>

<p>The <i>pthread_mutex_timedlock</i>() function may fail if:</p>

<dl compact>
<dt>[EINVAL]</dt>

<dd>The value specified by <i>mutex</i> does not refer to an initialized mutex object.</dd>

<dt>[EAGAIN]</dt>

<dd><sup>[<a href="javascript:open_code('XSI')">XSI</a>]</sup> <img src="../images/opt-start.gif" alt="[Option Start]" border="0">
The mutex could not be acquired because the maximum number of recursive locks for <i>mutex</i> has been exceeded. <img src=
"../images/opt-end.gif" alt="[Option End]" border="0"></dd>

<dt>[EDEADLK]</dt>

<dd>A deadlock condition was detected or the current thread already owns the mutex.</dd>
</dl>

<p>This function shall not return an error code of [EINTR].</p>
</blockquote>

<hr>
<div class="box"><em>The following sections are informative.</em></div>

<h4><a name="tag_03_542_06"></a>EXAMPLES</h4>

<blockquote>
<p>None.</p>
</blockquote>

<h4><a name="tag_03_542_07"></a>APPLICATION USAGE</h4>

<blockquote>
<p>The <i>pthread_mutex_timedlock</i>() function is part of the Threads and Timeouts options and need not be provided on all
implementations.</p>
</blockquote>

<h4><a name="tag_03_542_08"></a>RATIONALE</h4>

<blockquote>
<p>None.</p>
</blockquote>

<h4><a name="tag_03_542_09"></a>FUTURE DIRECTIONS</h4>

<blockquote>
<p>None.</p>
</blockquote>

<h4><a name="tag_03_542_10"></a>SEE ALSO</h4>

<blockquote>
<p><a href="pthread_mutex_destroy.html"><i>pthread_mutex_destroy</i>()</a>, <a href=
"pthread_mutex_lock.html"><i>pthread_mutex_lock</i>()</a>, <a href="pthread_mutex_trylock.html"><i>pthread_mutex_trylock</i>()</a>
, <a href="time.html"><i>time</i>()</a>, the Base Definitions volume of IEEE&nbsp;Std&nbsp;1003.1-2001, <a href=
"../basedefs/pthread.h.html"><i>&lt;pthread.h&gt;</i></a>, <a href="../basedefs/time.h.html"><i>&lt;time.h&gt;</i></a></p>
</blockquote>

<h4><a name="tag_03_542_11"></a>CHANGE HISTORY</h4>

<blockquote>
<p>First released in Issue 6. Derived from IEEE&nbsp;Std&nbsp;1003.1d-1999.</p>

<p>IEEE&nbsp;Std&nbsp;1003.1-2001/Cor&nbsp;2-2004, item XSH/TC2/D6/99 is applied, marking the last paragraph in the DESCRIPTION as
part of the Thread Priority Inheritance option.</p>

<p>IEEE&nbsp;Std&nbsp;1003.1-2001/Cor&nbsp;2-2004, item XSH/TC2/D6/100 is applied, updating the ERRORS section so that the
[EDEADLK] error includes detection of a deadlock condition.</p>
</blockquote>

<div class="box"><em>End of informative text.</em></div>

<hr size="2" noshade>
<center><font size="2"><!--footer start-->
UNIX &reg; is a registered Trademark of The Open Group.<br>
POSIX &reg; is a registered Trademark of The IEEE.<br>
[ <a href="../mindex.html">Main Index</a> | <a href="../basedefs/contents.html">XBD</a> | <a href=
"../utilities/contents.html">XCU</a> | <a href="../functions/contents.html">XSH</a> | <a href="../xrat/contents.html">XRAT</a>
]</font></center>

<!--footer end-->
<hr size="2" noshade>
</body>
</html>

